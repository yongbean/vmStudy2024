// Ubuntu 16.04
// Arch:     i386-32-little             sfp : 4 byte, ret : 4 byte
// RELRO:    No RELRO
// Stack:    No canary found
// NX:       NX disabled
// PIE:      No PIE (0x8048000)
// RWX:      Has RWX segments


#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <unistd.h>


void alarm_handler() {
    puts("TIME OUT");
    exit(-1);
}


void initialize() {
    setvbuf(stdin, NULL, _IONBF, 0);
    setvbuf(stdout, NULL, _IONBF, 0);

    signal(SIGALRM, alarm_handler);
    alarm(30);
}


int main(int argc, char *argv[]) {

    char buf[0x80];                 // 128 byte

    initialize();
    
    printf("buf = (%p)\n", buf);
    scanf("%141s", buf);            // 141 byte

    return 0;
}

// buf (128) + sfp (4) + ret (4)
// buf + sfp -> 132 -> shellcode + dummy  + ret